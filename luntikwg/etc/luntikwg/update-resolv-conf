#!/usr/bin/bash

case $1 in
up)
  #DNS(1/2) from /etc/luntikwg/wg0.conf
  echo "# Generated by LuntikWG" > /etc/resolv.conf
  ns=$(grep "^DNS" /etc/luntikwg/wg0.conf | cut -f3 -d' ')
  if [[ $(echo $ns | grep ',') ]]; then
  echo -e "nameserver $(echo $ns | cut -f1 -d',')\nnameserver $(echo $ns | cut -f2 -d',')" >> /etc/resolv.conf
     else
  echo -e "nameserver $ns\nnameserver 9.9.9.9" >> /etc/resolv.conf
  fi
  ;;
down)
  #DNS restore
  pgrep NetworkManager && systemctl restart NetworkManager.service || resolvconf -u
  ;;
esac

exit 0
